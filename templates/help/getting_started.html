{% extends "base.html" %}

{% block title %}Getting Started - Help - SilentCanary{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-md-3">
            <!-- Help Navigation Sidebar -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-book"></i> Documentation</h5>
                </div>
                <div class="list-group list-group-flush">
                    <a href="{{ url_for('help_overview') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-home"></i> Overview
                    </a>
                    <a href="{{ url_for('help_getting_started') }}" class="list-group-item list-group-item-action active">
                        <i class="fas fa-rocket"></i> Getting Started
                    </a>
                    <a href="{{ url_for('help_examples') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-lightbulb"></i> Real-World Examples
                    </a>
                    <a href="{{ url_for('help_smart_alerts') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-brain"></i> Smart Alerts
                    </a>
                    <a href="{{ url_for('help_api') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-code"></i> API Documentation
                    </a>
                    <a href="{{ url_for('help_cicd_integration') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-code-branch"></i> CI/CD Integration
                    </a>
                    <a href="{{ url_for('help_troubleshooting') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-wrench"></i> Troubleshooting
                    </a>
                    <a href="{{ url_for('help_faq') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-question"></i> FAQ
                    </a>
                </div>
            </div>
        </div>
        
        <div class="col-md-9">
            <!-- Main Content -->
            <div class="card">
                <div class="card-header">
                    <h1 class="h3 mb-0"><i class="fas fa-rocket text-primary"></i> Getting Started with SilentCanary</h1>
                </div>
                <div class="card-body">
                    
                    <!-- Introduction -->
                    <div class="alert alert-success">
                        <i class="fas fa-info-circle"></i>
                        This guide will walk you through setting up your first canary monitoring in under 5 minutes!
                    </div>

                    <!-- Step 1: Create Your First Canary -->
                    <section class="mb-5">
                        <h2 class="h4 mb-3"><span class="badge bg-primary me-2">1</span> Create Your First Canary</h2>
                        
                        <div class="row">
                            <div class="col-md-8">
                                <p>A <strong>canary</strong> represents a process, service, or job you want to monitor. Let's create one:</p>
                                
                                <ol>
                                    <li>Click <a href="{{ url_for('create_canary') }}" class="btn btn-sm btn-primary"><i class="fas fa-plus"></i> Create Canary</a> in the navigation</li>
                                    <li>Fill out the form with these details:</li>
                                </ol>
                                
                                <div class="card bg-light">
                                    <div class="card-body">
                                        <h6>Example Configuration:</h6>
                                        <ul class="list-unstyled mb-0">
                                            <li><strong>Name:</strong> "Daily Database Backup"</li>
                                            <li><strong>Check-in Interval:</strong> 1440 minutes (24 hours)</li>
                                            <li><strong>Grace Period:</strong> 30 minutes</li>
                                            <li><strong>Alert Type:</strong> Email</li>
                                            <li><strong>Tags:</strong> database, backup, critical</li>
                                            <li><strong>SLA Threshold:</strong> 99.5%</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-info">
                                    <div class="card-header bg-info text-white">
                                        <i class="fas fa-lightbulb"></i> Pro Tip
                                    </div>
                                    <div class="card-body">
                                        <p class="small mb-0">Start with longer intervals and shorter grace periods. You can always adjust based on your actual patterns!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Step 2: Get Your Check-in URL -->
                    <section class="mb-5">
                        <h2 class="h4 mb-3"><span class="badge bg-primary me-2">2</span> Get Your Check-in URL</h2>
                        
                        <p>After creating your canary, you'll see a unique check-in URL on your dashboard:</p>
                        
                        <div class="card bg-light">
                            <div class="card-body">
                                <div class="input-group">
                                    <input type="text" class="form-control" 
                                           value="https://silentcanary.com/checkin/a1b2c3d4-e5f6-7890-abcd-1234567890ef" 
                                           readonly>
                                    <button class="btn btn-outline-secondary" type="button">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="alert alert-warning mt-3">
                            <i class="fas fa-exclamation-triangle"></i>
                            <strong>Keep this URL secure!</strong> Anyone with this URL can send check-ins for your canary.
                        </div>
                    </section>

                    <!-- Step 3: Add Check-ins to Your Process -->
                    <section class="mb-5">
                        <h2 class="h4 mb-3"><span class="badge bg-primary me-2">3</span> Add Check-ins to Your Process</h2>
                        
                        <p>Add a simple HTTP request to your process. Here are examples for different scenarios:</p>
                        
                        <!-- Tabs for different methods -->
                        <ul class="nav nav-tabs" id="methodTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="curl-tab" data-bs-toggle="tab" data-bs-target="#curl" type="button">
                                    <i class="fas fa-terminal"></i> cURL
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="bash-tab" data-bs-toggle="tab" data-bs-target="#bash" type="button">
                                    <i class="fab fa-linux"></i> Bash Script
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="python-tab" data-bs-toggle="tab" data-bs-target="#python" type="button">
                                    <i class="fab fa-python"></i> Python
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="cron-tab" data-bs-toggle="tab" data-bs-target="#cron" type="button">
                                    <i class="fas fa-clock"></i> Cron Job
                                </button>
                            </li>
                        </ul>
                        
                        <div class="tab-content mt-3" id="methodTabContent">
                            <!-- cURL -->
                            <div class="tab-pane fade show active" id="curl" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">
                                        <h6>Simple GET Request:</h6>
                                        <pre><code>curl "https://silentcanary.com/checkin/your-token-here"</code></pre>
                                        
                                        <h6 class="mt-3">POST with Data:</h6>
                                        <pre><code>curl -X POST "https://silentcanary.com/checkin/your-token-here" \
     -d "status=success" \
     -d "message=Backup completed successfully"</code></pre>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Bash Script -->
                            <div class="tab-pane fade" id="bash" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">
                                        <h6>Complete Backup Script Example:</h6>
<pre><code>#!/bin/bash
# database-backup.sh

CANARY_URL="https://silentcanary.com/checkin/your-token-here"
BACKUP_DIR="/backups/database"
DATE=$(date +%Y%m%d_%H%M%S)

echo "Starting database backup..."

# Your backup commands here
pg_dump -h localhost -U postgres mydb > "$BACKUP_DIR/backup_$DATE.sql"

# Check if backup was successful
if [ $? -eq 0 ]; then
    echo "Backup completed successfully"
    # Notify SilentCanary of success
    curl -X POST "$CANARY_URL" \
         -d "status=success" \
         -d "message=Database backup completed at $DATE"
else
    echo "Backup failed!"
    # You could optionally notify of failure too
    curl -X POST "$CANARY_URL" \
         -d "status=failed" \
         -d "message=Database backup failed at $DATE"
    exit 1
fi</code></pre>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Python -->
                            <div class="tab-pane fade" id="python" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">
                                        <h6>Python Script Example:</h6>
<pre><code>#!/usr/bin/env python3
import requests
import sys
from datetime import datetime

CANARY_URL = "https://silentcanary.com/checkin/your-token-here"

def notify_silentcanary(status="success", message=""):
    """Send check-in to SilentCanary"""
    try:
        data = {"status": status, "message": message}
        response = requests.post(CANARY_URL, data=data, timeout=10)
        if response.status_code == 200:
            print(f"✅ SilentCanary notified: {status}")
        else:
            print(f"❌ SilentCanary notification failed: {response.status_code}")
    except Exception as e:
        print(f"❌ Error notifying SilentCanary: {e}")

def main():
    """Your main process logic"""
    try:
        print("Starting data processing...")
        
        # Your actual work here
        # process_data()
        # generate_reports()
        
        print("Processing completed successfully")
        notify_silentcanary("success", f"Data processing completed at {datetime.now()}")
        
    except Exception as e:
        print(f"❌ Processing failed: {e}")
        notify_silentcanary("failed", f"Data processing failed: {str(e)}")
        sys.exit(1)

if __name__ == "__main__":
    main()</code></pre>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Cron Job -->
                            <div class="tab-pane fade" id="cron" role="tabpanel">
                                <div class="card">
                                    <div class="card-body">
                                        <h6>Cron Job Examples:</h6>
<pre><code># Edit your crontab with: crontab -e

# Daily backup at 2 AM
0 2 * * * /path/to/backup-script.sh && curl "https://silentcanary.com/checkin/your-token"

# Hourly health check
0 * * * * /path/to/health-check.py && curl -X POST "https://silentcanary.com/checkin/your-token" -d "status=healthy"

# Weekly report generation (Sundays at 6 AM)
0 6 * * 0 /path/to/weekly-report.sh && curl "https://silentcanary.com/checkin/your-token"

# Multiple commands with error handling
*/30 * * * * /path/to/sync-script.sh && curl "https://silentcanary.com/checkin/your-token" || curl -X POST "https://silentcanary.com/checkin/your-token" -d "status=failed"</code></pre>
                                        
                                        <div class="alert alert-info mt-3">
                                            <i class="fas fa-info-circle"></i>
                                            <strong>Tip:</strong> The <code>&&</code> operator ensures the check-in only happens if your script succeeds!
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Step 4: Test Your Setup -->
                    <section class="mb-5">
                        <h2 class="h4 mb-3"><span class="badge bg-primary me-2">4</span> Test Your Setup</h2>
                        
                        <div class="row">
                            <div class="col-md-8">
                                <p>Before deploying, test that everything works:</p>
                                
                                <ol>
                                    <li><strong>Manual Test:</strong> Run your process manually and verify the check-in appears on your dashboard</li>
                                    <li><strong>Test Failure:</strong> Temporarily disable the check-in and wait for the alert (grace period + interval)</li>
                                    <li><strong>Verify Notifications:</strong> Check that you receive emails/Slack messages</li>
                                </ol>
                                
                                <div class="card bg-light">
                                    <div class="card-body">
                                        <h6>Quick Test Commands:</h6>
<pre><code># Test successful check-in
curl "https://silentcanary.com/checkin/your-token"

# Test with status data
curl -X POST "https://silentcanary.com/checkin/your-token" \
     -d "status=testing" \
     -d "message=Manual test from terminal"</code></pre>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-success">
                                    <div class="card-header bg-success text-white">
                                        <i class="fas fa-check-circle"></i> Success!
                                    </div>
                                    <div class="card-body">
                                        <p class="small mb-0">If you see "Last Check-in: Just now" on your dashboard, you're all set!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Step 5: Advanced Features -->
                    <section class="mb-5">
                        <h2 class="h4 mb-3"><span class="badge bg-success me-2">5</span> Explore Advanced Features</h2>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5><i class="fas fa-brain text-primary"></i> Smart Alerts</h5>
                                        <p>Enable ML-powered anomaly detection that learns your patterns and sends smarter alerts.</p>
                                        <a href="{{ url_for('help_smart_alerts') }}" class="btn btn-primary btn-sm">Learn More</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5><i class="fas fa-chart-line text-success"></i> Analytics</h5>
                                        <p>View detailed uptime statistics, SLA reports, and export your data.</p>
                                        <a href="{{ url_for('dashboard') }}" class="btn btn-success btn-sm">View Dashboard</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Common Gotchas -->
                    <section class="mb-4">
                        <h2 class="h4 mb-3"><i class="fas fa-exclamation-triangle text-warning"></i> Common Gotchas</h2>
                        
                        <div class="accordion" id="gotchasAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#gotcha1">
                                        My process runs but I'm not getting check-ins
                                    </button>
                                </h2>
                                <div id="gotcha1" class="accordion-collapse collapse" data-bs-parent="#gotchasAccordion">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>Check that your process can reach the internet</li>
                                            <li>Verify the URL is correct (copy-paste from dashboard)</li>
                                            <li>Check firewall rules and proxy settings</li>
                                            <li>Test manually with curl from the same environment</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#gotcha2">
                                        I'm getting false alarms
                                    </button>
                                </h2>
                                <div id="gotcha2" class="accordion-collapse collapse" data-bs-parent="#gotchasAccordion">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>Increase the grace period to account for normal variations</li>
                                            <li>Consider using Smart Alerts to reduce false positives</li>
                                            <li>Review your process timing and adjust interval accordingly</li>
                                            <li>Check if your process sometimes takes longer than expected</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#gotcha3">
                                        My cron job is running but not checking in
                                    </button>
                                </h2>
                                <div id="gotcha3" class="accordion-collapse collapse" data-bs-parent="#gotchasAccordion">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>Use absolute paths in your cron commands</li>
                                            <li>Set proper environment variables (PATH, etc.)</li>
                                            <li>Add logging to see what's happening: <code>yourscript.sh >> /var/log/canary.log 2>&1</code></li>
                                            <li>Test your cron syntax with online validators</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Next Steps -->
                    <section class="border-top pt-4">
                        <h3 class="h5 mb-3">Next Steps</h3>
                        <div class="btn-group" role="group">
                            <a href="{{ url_for('help_examples') }}" class="btn btn-primary">
                                <i class="fas fa-lightbulb"></i> See Real Examples
                            </a>
                            <a href="{{ url_for('help_smart_alerts') }}" class="btn btn-outline-primary">
                                <i class="fas fa-brain"></i> Smart Alerts Guide
                            </a>
                            <a href="{{ url_for('help_troubleshooting') }}" class="btn btn-outline-secondary">
                                <i class="fas fa-wrench"></i> Troubleshooting
                            </a>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}